<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/>
    <meta name="description" content=""/>
    <meta name="author" content=""/>
    <title>Agency - Start Bootstrap Theme</title>
    <link rel="icon" type="image/x-icon" href="assets/img/favicon.ico"/>
    <!-- Font Awesome icons (free version)-->
    <script src="https://use.fontawesome.com/releases/v5.15.1/js/all.js" crossorigin="anonymous"></script>
    <!-- Google fonts-->
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css"/>
    <link href="https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic,700italic" rel="stylesheet"
          type="text/css"/>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Slab:400,100,300,700" rel="stylesheet" type="text/css"/>
    <!-- Core theme CSS (includes Bootstrap)-->
    <link href="/client/css/styles.css" rel="stylesheet"/>
</head>
<body id="page-top">
<!-- Navigation-->
<nav class="navbar navbar-expand-lg navbar-dark fixed-top" id="mainNav">
    <div class="container">
        <a class="navbar-brand" href="#">momen</a>
        <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse"
                data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false"
                aria-label="Toggle navigation">
            Menu
            <i class="fas fa-bars ml-1"></i>
        </button>
        <div class="collapse navbar-collapse" id="navbarResponsive">

            <ul class="navbar-nav text-uppercase ml-auto">
                <li class="nav-item"><a class="nav-link js-scroll-trigger" href="/management/activiteclient">activitées</a></li>
                <li class="nav-item"><a class="nav-link js-scroll-trigger" href="/management/clienthotel">Hotels</a></li>
                {% if is_granted("ROLE_ATHELET") %}
                    <li class="nav-item"><a class="nav-link js-scroll-trigger" href="{{ path('athtelearticles', {'id': app.user.id}) }}">my articles</a></li>
                {% endif %}
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" data-toggle="dropdown"
                       aria-haspopup="true" aria-expanded="false">
                        <i class="fas fa-user"></i>
                    </a>
                    <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">

                        <button class="dropdown-item" onclick="editUser()" href="#">Profile</button>
                        <a class="dropdown-item" href="/logout">Logout</a>
                    </div>
                </li>

            </ul>

        </div>
    </div>
</nav>
<!-- Masthead-->
{% block masthead %}
    <header class="masthead">
        <div class="container">
            <div class="masthead-subheading">Welcome To exterme Tunisia!</div>
            <div class="masthead-heading text-uppercase">It's Nice To Meet You</div>
        </div>
    </header>
{% endblock %}
<!-- Services-->

{% block body %}{% endblock %}
<!-- Bootstrap core JS-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="//cdn.jsdelivr.net/npm/sweetalert2@10"></script>
<!-- Third party plugin JS-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>
<!-- Contact form JS-->
<script src="/client/assets/mail/jqBootstrapValidation.js"></script>
<script src="/client/assets/mail/contact_me.js"></script>
<!-- Core theme JS-->
<script src="/client/js/scripts.js"></script>
<script>
    const editUser = () => {
        Swal.fire({
            title: 'Login Form',
            html: ` <input type="text" id=lname_{{ app.user.id }} class="swal2-input" placeholder="Last Name" value={{ app.user.nom }}>
                <input type="text" id=fname_{{ app.user.id }} class="swal2-input" placeholder="First Name" value={{ app.user.prenom }}>
                <input type="text" id=tel_{{ app.user.id }} class="swal2-input" placeholder="Telephone" value={{ app.user.tel }}>`,
            confirmButtonText: 'Update',
            focusConfirm: false,
            preConfirm: () => {
                const lname = Swal.getPopup().querySelector('#lname_{{ app.user.id }}').value;
                const fname = Swal.getPopup().querySelector('#fname_{{ app.user.id }}').value;
                const tel = Swal.getPopup().querySelector('#tel_{{ app.user.id }}').value;

                console.log(lname, fname, tel);
                if (!lname || !fname || !tel) {
                    Swal.showValidationMessage(`Please enter the values ♥ `);
                }
                return {lname, fname, tel};
            }
        }).then((result) => {
            console.log(result.value);
            fetch("{{ app.request.schemeAndHttpHost }}/user/{{ app.user.id }}/edit", {
                method: 'POST',
                headers: {
                    'Accept': 'application/json',
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(result.value)
            })
                .then(result => result)
                .then(data => {
                    console.log(data);
                })
                .catch(error => console.log(error))
            Swal.fire("every thing is updated with success ♥ ".trim());
        }).then(res => {
            location.reload();
        });

    }

</script>
</body>
</html>
